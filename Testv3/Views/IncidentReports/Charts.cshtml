  @model Testv3.Models.StudentInterviewViewModel

@{
    ViewBag.Title = "Charts";
}


@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="body-content">
        <div class="form-horizontal">

            <canvas id="reportedBy-pie-chart" width="657" height="150" style="width: 657px; height: 150px;"></canvas>
            <br /><br />
            <canvas id="line-chart" width="657" height="150" style="width: 657px; height: 150px;"></canvas>            
     
        </div>
    </div>
}
@section Scripts{
    <script type="text/javascript">

        //bar chart
        var label1 = [];
        var barchart = {
            labels: label1,
            datasets: [
                {
                    label: "Total",
                    backgroundColor: "rgba(255,99,132,0.2)",
                    borderColor: "rgba(255,99,132,1)",
                    borderWidth: 2,
                    hoverBackgroundColor: "rgba(255,99,132,0.4)",
                    hoverBorderColor: "rgba(255,99,132,1)",
                    data: [],
                }
            ]
        };
        var option = {
            legend: { display: false },
            title: {
                display: true,
                text: 'Incident Types Summary'
            },

            scales: {
                yAxes: [{
                    stacked: true,
                    gridLines: {
                        display: true,
                        color: "rgba(255,99,132,0.2)"
                    }
                }],
                xAxes: [{
                    gridLines: {
                        display: false
                    }
                }]
            }
        };


        $.ajax({
            url: '/IncidentReports/GetIncidentTypesSummary/',
            success: function (response) {

                $.each(response, function (i, item) {
                    label1.push(item.Type); 
                    barchart.datasets[0].data.push(item.count);
                })

                var ctx = document.getElementById("line-chart").getContext("2d");

                var myLineChart = new Chart(ctx,
                    {
                        type: 'bar',
                        data: barchart,
                        options: option
                    });
            }

            });


        //pie chart
        var pieChart = {
                labels: ["Counsellor","Student"],
                datasets: [{
                            backgroundColor:
                            [
                                "rgba(153, 102, 255, 0.2)",
                                "rgba(255, 205, 86, 0.2)"
                            ],
                            borderColor:
                            [
                                "rgb(153, 102, 255)",
                                "rgba(255, 205, 86, 0.2)"
                            ],
                            borderWidth: 1,
                            data: []
                }]

        }

        var optionPieChart = {
            legend: { position: 'top' },
            title: {
                display: true,
                text: 'Incident Reports Filed by Student and Counsellor'
            }
        };

 

            $.ajax({
                url: '/IncidentReports/GetReportersSummary/',
                success: function (responsePie) {

                    $.each(responsePie, function (i, item) {

                        pieChart.datasets[0].data.push(parseInt(item.counsellorCount), parseInt(item.studentCount));
                    })

                    var ctx2 = document.getElementById("reportedBy-pie-chart").getContext("2d");

                    var myPieChart = new Chart(ctx2,
                        {
                            type: 'pie',
                            data: pieChart,
                            options: optionPieChart
                        });
                }

            });





    </script>
}